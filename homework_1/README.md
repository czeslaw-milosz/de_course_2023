# Homework 1: mock data sources
-----------------------------------

## 1. Introduction
This repository contains a simple mock data pipeline. The data are JSON records containing mock information about users and their posts (random strings of 150 characters, think: simulating Twitter posts); a sample single record looks like this:
```{JSON}
{
    "user_id": "6e0e1f98-9e7e-4746-9abe-21ef9f95664d",
    "comment_id": 326524,
    "name": "John Koehler",
    "age": 73,
    "content": "zCRJhYXwHuwPFGzJxrvyrOjAasQKzhENLLJaZkYeYFPKgcQLLudVvdnZNVXITnOBmebwKLhaGMWNCnoPsTHQJdXvATGJQTCLLIva"
}
```

These records are generated by a (very) simple API with one GET endpoint that returns a batch of 2000 records per request.

A Python script gets 10 batches of records from the API (so total of 20 000 records), pushes them in a Pulsar queue, then collects them from the queue, saves to a file and posts the file to MinIO.

MinIO, Pulsar and FastAPI are run locally in separate docker containers. The whole pipeline can be configured by changing the `.env` file.

## 2. Setup and execution

To run the whole process end to end, just use the driver script:
```{bash}
./run.sh
```
This creates a temporary Python environment, installs the required packages, sets up the services and runs the pipeline. The resulting file can be viewed (after loggin in with credentials from `.env`) on MinIO available at `http://localhost:9090`. To shut down and remove the containers, run `make teardown`.

Apart from this, there is a Makefile that follows the following options:
 - `make setup` - sets up MinIO, FastAPI and Pulsar containers.
 - `make teardown` - opposite of setup.
 - `make clean` - cleans python cache.
 - `make app` - builds just the FastAPI app.
 - `make minio` - sets up just the MinIO instance.
 - `make pulsar` - sets up just the Pulsar instance.
